# RCEmap

```
Author：
           ___     ___     __ 
          / _ \___<  /__  / /_
         / ___/ __/ / _ \/ __/
        /_/  /_/ /_/_//_/\__/ 
                      
██████╗  ██████╗███████╗███╗   ███╗ █████╗ ██████╗ 
██╔══██╗██╔════╝██╔════╝████╗ ████║██╔══██╗██╔══██╗
██████╔╝██║     █████╗  ██╔████╔██║███████║██████╔╝
██╔══██╗██║     ██╔══╝  ██║╚██╔╝██║██╔══██║██╔═══╝ 
██║  ██║╚██████╗███████╗██║ ╚═╝ ██║██║  ██║██║     
╚═╝  ╚═╝ ╚═════╝╚══════╝╚═╝     ╚═╝╚═╝  ╚═╝╚═╝      
```

## 免责声明
本工具仅作为ctf题目中节省rce手测时间的自动化工具，禁止用于非法用途

## 简介 
这是一款类似sqlmap的RCE自动化工具

v1.0将具有如下功能：
1. 自动绕过php语言黑名单过滤
2. 无数字字母RCE
3. 部分特殊字符被限制绕过
4. 限定字符数量RCE

目标：  
1. 支持多语言RCE题目，如php, java，的过滤绕过与自动执行指定命令
2. 各框架（如thinkPHP）RCE漏洞自动打poc

预计将发布四个大版本，分别是
第一阶段： 无GUI的php版RCEmap  
第二阶段： 有GUI版本  
第三阶段： 带Java的版本   
最终阶段： 带各框架漏洞的自动化RCE工具  


## ToDo
这个部分是后加的，本来没想写todo的，但是随着学习的深入和更多比赛的参加发现rce类型实在是太多了，于是这里写了个todo

- [x] 完善fuzzpro
- [ ] 少量字符rce，例如7字符
- [ ] 利用环境变量拼接rce
- [ ] 允许使用字典进行fuzz
- [ ] 允许用户自己编写脚本

## 更新日志

3月16日发布第一版v0.1,实现了最容易的功能：在php7.x版本下，在能够使用`(` `)` `~` `;`的情况下，在题目是eval的情况下，实现rce  

3月17日v0.2更新说明：在system的情况下实现无数字字母，新增二开后的bashfuck工具，优化代码结构，增加彩色INFO和WARNING信息，不用额外的qufan.py，并新增fuzz函数(后续会用到)  

3月21日v0.3更新说明：新增在php5.x版本下，使用`><?=. /[-[];`这些字符进行rce，新增异或方法

3月27日v0.4更新说明：更新自增和%ff方法，彻底结束无数字字母RCE部分，即将开始黑名单绕过与无源码fuzz阶段，离v1.0越来越近了喵🥰

4月17日v0.5更新说明：新增无源码下fuzzpro出可用字符~~然后加以利用~~，增加代码可读性，优化代码结构  

隔了好久好不容易更新了一次估计又得停更好久，v1.0的发布也会延后好久，虽然现在能通用的脚本只差一个pwd，但是要做到当初承诺的能akphp版rce题目还有很长一段路，而且要去挖证书了，所以很少有时间会更新了  ~~我尽量这学期发布v1.0~~
要看开发笔记的话欢迎访问我的博客(虽然现在还没什么东西,不过过几天就会把一些真是笔记的东西写上去)[仙人指路](https://w0r1d-pr1nt.github.io/)

## 使用方法
#### v0.1使用方法：
`./rcemap.exe --help`,可以查看目前仅有的四个参数,其中-v参数无用,不是php7.x的版本的东西还没写,将会在v0.2以后更新出来,如果-c后的内容为`system(ipconfig)`之类的内容建议使用双引号包裹起来,不然有可能会报错或者达不到预期目标(注:--help中使用方法有误,**或者**后的内容应为./rcemap.exe --help)（欸对，得搭配qufan.py一起使用，不然不好使，记得下下来，放在同一目录）  
#### v0.2使用方法：
`./rcemap.exe --help`，可以查看参数，v0.1中说的7.x版本内容还没写，等我后续继续更新，这个v0.2不用搭配qufan.py了，内置了
#### v0.3使用方法：
还是没变，最主要的是建议设置v
#### v0.4使用方法：
建议把这几个参数都设置上吧，反正也不多，然后自增方法在php5.x好像不好使，然后c里面的内容最好用双引号括起来，不然有可能被powershell视为其他东西导致不执行
#### v0.5使用说明：
~~离世界级项目越来越近了~~  额外写了一个fuzzpro脚本负责进行fuzz (x),优化代码结构,便于二开,以后也许会加上例如sqlmap一样可以自己编写脚本的功能

## 备注
部分特殊题目做不了，比如ctfshowRCE最后一道题，那种的需要使用限定的解题方法就不是我这种工具里能涵盖的了，包括n1ctf中zako那道题，那种考察是思维的东西，考察grep命令的用法，我这工具做不到解出来那种题，哪怕我发布的最终版也做不到这种效果，那得是接入人工智能的才行了  

> ~~既然无法接入人工智能,为什么不直接接入人工呢~~  (这句话是在突然想到能让用户自己编写脚本来跑之后想到的)