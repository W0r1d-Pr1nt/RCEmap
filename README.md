# RCEmap

```
Authorï¼š
           ___     ___     __ 
          / _ \___<  /__  / /_
         / ___/ __/ / _ \/ __/
        /_/  /_/ /_/_//_/\__/ 
                      
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— 
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â• 
â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     
â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•â•šâ•â•      
```

## å…è´£å£°æ˜Ž
æœ¬å·¥å…·ä»…ä½œä¸ºctfé¢˜ç›®ä¸­èŠ‚çœrceæ‰‹æµ‹æ—¶é—´çš„è‡ªåŠ¨åŒ–å·¥å…·ï¼Œç¦æ­¢ç”¨äºŽéžæ³•ç”¨é€”

## ç®€ä»‹ 
è¿™æ˜¯ä¸€æ¬¾ç±»ä¼¼sqlmapçš„RCEè‡ªåŠ¨åŒ–å·¥å…·

v1.0å°†å…·æœ‰å¦‚ä¸‹åŠŸèƒ½ï¼š
1. è‡ªåŠ¨ç»•è¿‡phpè¯­è¨€é»‘åå•è¿‡æ»¤
2. æ— æ•°å­—å­—æ¯RCE
3. éƒ¨åˆ†ç‰¹æ®Šå­—ç¬¦è¢«é™åˆ¶ç»•è¿‡
4. é™å®šå­—ç¬¦æ•°é‡RCE

ç›®æ ‡ï¼š  
1. æ”¯æŒå¤šè¯­è¨€RCEé¢˜ç›®ï¼Œå¦‚php, javaï¼Œçš„è¿‡æ»¤ç»•è¿‡ä¸Žè‡ªåŠ¨æ‰§è¡ŒæŒ‡å®šå‘½ä»¤
2. å„æ¡†æž¶ï¼ˆå¦‚thinkPHPï¼‰RCEæ¼æ´žè‡ªåŠ¨æ‰“poc

é¢„è®¡å°†å‘å¸ƒå››ä¸ªå¤§ç‰ˆæœ¬ï¼Œåˆ†åˆ«æ˜¯
ç¬¬ä¸€é˜¶æ®µï¼š æ— GUIçš„phpç‰ˆRCEmap  
ç¬¬äºŒé˜¶æ®µï¼š æœ‰GUIç‰ˆæœ¬  
ç¬¬ä¸‰é˜¶æ®µï¼š å¸¦Javaçš„ç‰ˆæœ¬   
æœ€ç»ˆé˜¶æ®µï¼š å¸¦å„æ¡†æž¶æ¼æ´žçš„è‡ªåŠ¨åŒ–RCEå·¥å…·  

## æ›´æ–°æ—¥å¿—

3æœˆ16æ—¥å‘å¸ƒç¬¬ä¸€ç‰ˆv0.1,å®žçŽ°äº†æœ€å®¹æ˜“çš„åŠŸèƒ½ï¼šåœ¨php7.xç‰ˆæœ¬ä¸‹ï¼Œåœ¨èƒ½å¤Ÿä½¿ç”¨`(` `)` `~` `;`çš„æƒ…å†µä¸‹ï¼Œåœ¨é¢˜ç›®æ˜¯evalçš„æƒ…å†µä¸‹ï¼Œå®žçŽ°rce  

3æœˆ17æ—¥v0.2æ›´æ–°è¯´æ˜Žï¼šåœ¨systemçš„æƒ…å†µä¸‹å®žçŽ°æ— æ•°å­—å­—æ¯ï¼Œæ–°å¢žäºŒå¼€åŽçš„bashfuckå·¥å…·ï¼Œä¼˜åŒ–ä»£ç ç»“æž„ï¼Œå¢žåŠ å½©è‰²INFOå’ŒWARNINGä¿¡æ¯ï¼Œä¸ç”¨é¢å¤–çš„qufan.pyï¼Œå¹¶æ–°å¢žfuzzå‡½æ•°(åŽç»­ä¼šç”¨åˆ°)  

3æœˆ21æ—¥v0.3æ›´æ–°è¯´æ˜Žï¼šæ–°å¢žåœ¨php5.xç‰ˆæœ¬ä¸‹ï¼Œä½¿ç”¨`><?=. /[-[];`è¿™äº›å­—ç¬¦è¿›è¡Œrceï¼Œæ–°å¢žå¼‚æˆ–æ–¹æ³•

3æœˆ27æ—¥v0.4æ›´æ–°è¯´æ˜Žï¼šæ›´æ–°è‡ªå¢žå’Œ%ffæ–¹æ³•ï¼Œå½»åº•ç»“æŸæ— æ•°å­—å­—æ¯RCEéƒ¨åˆ†ï¼Œå³å°†å¼€å§‹é»‘åå•ç»•è¿‡ä¸Žæ— æºç fuzzé˜¶æ®µï¼Œç¦»v1.0è¶Šæ¥è¶Šè¿‘äº†å–µðŸ¥°
## ä½¿ç”¨æ–¹æ³•
#### v0.1ä½¿ç”¨æ–¹æ³•ï¼š
`./rcemap.exe --help`,å¯ä»¥æŸ¥çœ‹ç›®å‰ä»…æœ‰çš„å››ä¸ªå‚æ•°,å…¶ä¸­-vå‚æ•°æ— ç”¨,ä¸æ˜¯php7.xçš„ç‰ˆæœ¬çš„ä¸œè¥¿è¿˜æ²¡å†™,å°†ä¼šåœ¨v0.2ä»¥åŽæ›´æ–°å‡ºæ¥,å¦‚æžœ-cåŽçš„å†…å®¹ä¸º`system(ipconfig)`ä¹‹ç±»çš„å†…å®¹å»ºè®®ä½¿ç”¨åŒå¼•å·åŒ…è£¹èµ·æ¥,ä¸ç„¶æœ‰å¯èƒ½ä¼šæŠ¥é”™æˆ–è€…è¾¾ä¸åˆ°é¢„æœŸç›®æ ‡(æ³¨:--helpä¸­ä½¿ç”¨æ–¹æ³•æœ‰è¯¯,**æˆ–è€…**åŽçš„å†…å®¹åº”ä¸º./rcemap.exe --help)ï¼ˆæ¬¸å¯¹ï¼Œå¾—æ­é…qufan.pyä¸€èµ·ä½¿ç”¨ï¼Œä¸ç„¶ä¸å¥½ä½¿ï¼Œè®°å¾—ä¸‹ä¸‹æ¥ï¼Œæ”¾åœ¨åŒä¸€ç›®å½•ï¼‰  
#### v0.2ä½¿ç”¨æ–¹æ³•ï¼š
`./rcemap.exe --help`ï¼Œå¯ä»¥æŸ¥çœ‹å‚æ•°ï¼Œv0.1ä¸­è¯´çš„7.xç‰ˆæœ¬å†…å®¹è¿˜æ²¡å†™ï¼Œç­‰æˆ‘åŽç»­ç»§ç»­æ›´æ–°ï¼Œè¿™ä¸ªv0.2ä¸ç”¨æ­é…qufan.pyäº†ï¼Œå†…ç½®äº†
#### v0.3ä½¿ç”¨æ–¹æ³•ï¼š
è¿˜æ˜¯æ²¡å˜ï¼Œæœ€ä¸»è¦çš„æ˜¯å»ºè®®è®¾ç½®v
#### v0.4ä½¿ç”¨æ–¹æ³•ï¼š
å»ºè®®æŠŠè¿™å‡ ä¸ªå‚æ•°éƒ½è®¾ç½®ä¸Šå§ï¼Œåæ­£ä¹Ÿä¸å¤šï¼Œç„¶åŽè‡ªå¢žæ–¹æ³•åœ¨php5.xå¥½åƒä¸å¥½ä½¿ï¼Œç„¶åŽcé‡Œé¢çš„å†…å®¹æœ€å¥½ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œä¸ç„¶æœ‰å¯èƒ½è¢«powershellè§†ä¸ºå…¶ä»–ä¸œè¥¿å¯¼è‡´ä¸æ‰§è¡Œ

## å¤‡æ³¨
éƒ¨åˆ†ç‰¹æ®Šé¢˜ç›®åšä¸äº†ï¼Œæ¯”å¦‚ctfshowRCEæœ€åŽä¸€é“é¢˜ï¼Œé‚£ç§çš„éœ€è¦ä½¿ç”¨é™å®šçš„è§£é¢˜æ–¹æ³•å°±ä¸æ˜¯æˆ‘è¿™ç§å·¥å…·é‡Œèƒ½æ¶µç›–çš„äº†ï¼ŒåŒ…æ‹¬n1ctfä¸­zakoé‚£é“é¢˜ï¼Œé‚£ç§è€ƒå¯Ÿæ˜¯æ€ç»´çš„ä¸œè¥¿ï¼Œè€ƒå¯Ÿgrepå‘½ä»¤çš„ç”¨æ³•ï¼Œæˆ‘è¿™å·¥å…·åšä¸åˆ°è§£å‡ºæ¥é‚£ç§é¢˜ï¼Œå“ªæ€•æˆ‘å‘å¸ƒçš„æœ€ç»ˆç‰ˆä¹Ÿåšä¸åˆ°è¿™ç§æ•ˆæžœï¼Œé‚£å¾—æ˜¯æŽ¥å…¥äººå·¥æ™ºèƒ½çš„æ‰è¡Œäº†